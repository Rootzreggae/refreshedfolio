---
import { type CollectionEntry, getCollection } from 'astro:content';
import BaseLayout from '../../layouts/BaseLayout.astro';

export async function getStaticPaths() {
  const notes = await getCollection('notes');
  return notes.map((note) => ({
    params: { slug: note.slug },
    props: note,
  }));
}

type Props = CollectionEntry<'notes'>;

const note = Astro.props;
const { Content } = await note.render();
const { title, description, publishDate, tags } = note.data;
---

<BaseLayout title={title} description={description}>
  <main class="mx-auto max-w-3xl px-4 py-8">
    <article>
      <header class="mb-8">
        <h1 class="mb-4 text-4xl font-bold">{title}</h1>
        <p class="mb-4 text-lg text-gray-400">{description}</p>
        <div class="flex items-center gap-4 text-sm text-gray-500">
          <time datetime={publishDate.toISOString()}>
            {
              publishDate.toLocaleDateString('en-US', {
                year: 'numeric',
                month: 'long',
                day: 'numeric',
              })
            }
          </time>
          {
            tags.length > 0 && (
              <div class="flex gap-2">
                {tags.map((tag) => (
                  <span class="rounded bg-gray-800 px-2 py-1 text-xs">
                    {tag}
                  </span>
                ))}
              </div>
            )
          }
        </div>
      </header>

      <div class="prose prose-invert prose-gray max-w-none">
        <Content />
      </div>
    </article>
  </main>
</BaseLayout>
